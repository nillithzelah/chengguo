# ECPM数据管理模块

## 📊 功能概述

ECPM（Effective Cost Per Mille）数据管理模块是抖音广告管理系统的重要组成部分，专门用于管理和分析广告投放的成本效益数据。

## 🎯 核心功能

### 数据收集
- **实时数据获取** - 从抖音开放平台实时获取eCPM数据
- **多维度统计** - 支持按应用、日期、用户等多维度统计
- **数据验证** - 自动验证数据完整性和准确性

### 数据展示
- **可视化图表** - 直观的eCPM趋势图和统计图表
- **数据表格** - 详细的数据明细表格展示
- **统计卡片** - 关键指标的快速概览

### 数据管理
- **数据筛选** - 支持按时间范围、应用等条件筛选
- **数据导出** - 支持数据导出功能
- **数据缓存** - 本地数据缓存，提升加载速度

## 🏗️ 技术架构

### 前端组件结构
```
ecpm-simple/
├── index.vue          # 主页面组件
├── components/        # 子组件目录
│   ├── chart.vue     # 图表组件
│   ├── table.vue     # 表格组件
│   └── filter.vue    # 筛选组件
└── utils/            # 工具函数
    ├── data-parser.js    # 数据解析
    ├── chart-config.js   # 图表配置
    └── export-utils.js   # 导出工具
```

### 数据流程
```
抖音API → 数据获取 → 数据处理 → 数据展示 → 用户交互
```

## 📋 API接口

### 数据获取接口
```javascript
// 获取eCPM数据
GET /api/douyin/ecpm

// 参数说明
{
  mp_id: "应用ID",
  date_hour: "查询日期",
  page_no: "页码",
  page_size: "每页数量"
}
```

### 数据统计接口
```javascript
// 获取统计数据
GET /api/douyin/ecpm/stats

// 返回数据结构
{
  totalRecords: 1000,      // 总记录数
  totalRevenue: "500.00",  // 总收益
  totalEcpm: "0.50",       // 平均eCPM
  totalUsers: 500          // 活跃用户数
}
```

## 🎨 UI设计

### 页面布局
- **顶部统计区域** - 显示关键指标
- **筛选条件区域** - 数据筛选控件
- **图表展示区域** - 数据可视化图表
- **数据表格区域** - 详细数据列表

### 响应式设计
- **桌面端** - 完整的布局和功能
- **移动端** - 适配移动设备的简化布局
- **平板端** - 介于桌面和移动之间的布局

## 🔧 配置选项

### 图表配置
```javascript
const chartOptions = {
  type: 'line',           // 图表类型
  data: chartData,        // 图表数据
  options: {
    responsive: true,     // 响应式
    maintainAspectRatio: false  // 保持宽高比
  }
};
```

### 表格配置
```javascript
const tableColumns = [
  { key: 'event_time', title: '事件时间', width: 180 },
  { key: 'username', title: '用户名', width: 120 },
  { key: 'revenue', title: '收益', width: 100 },
  { key: 'city', title: '城市', width: 120 }
];
```

## 📊 数据格式

### 原始数据格式
```javascript
{
  event_time: "2025-09-15 10:00:00",
  open_id: "user_123456",
  aid: "ad_789",
  cost: 100000,          // 单位：分（100000 = 1000元）
  source: "抖音",
  ip: "192.168.1.1",
  city: "深圳",
  phone_brand: "iPhone",
  phone_model: "iPhone 14"
}
```

### 处理后数据格式
```javascript
{
  id: 1,
  event_time: "2025-09-15 10:00:00",
  username: "用户A",
  open_id: "user_123456",
  aid: "ad_789",
  revenue: 1000,         // 转换为元
  city: "深圳",
  phone_brand: "iPhone",
  phone_model: "iPhone 14"
}
```

## 🚀 使用指南

### 基本使用
1. **选择应用** - 从下拉菜单选择要查看的应用
2. **设置日期** - 选择要查询的数据日期
3. **点击查询** - 获取eCPM数据
4. **查看结果** - 在图表和表格中查看数据

### 高级功能
1. **数据导出** - 导出数据到Excel或CSV文件
2. **图表交互** - 点击图表元素查看详细数据
3. **数据筛选** - 使用筛选条件精确查找数据

## 🔍 调试功能

### 调试模式启用
```javascript
// 在浏览器控制台中执行
localStorage.setItem('debug_mode', 'true');
```

### 调试信息查看
- **API请求日志** - 查看所有API请求和响应
- **数据处理日志** - 查看数据转换过程
- **错误信息** - 查看系统错误和异常

## 🐛 常见问题

### 数据获取失败
**问题**: API请求失败或无数据返回
**解决**:
1. 检查网络连接
2. 验证API密钥配置
3. 检查抖音开放平台权限

### 数据显示异常
**问题**: 数据格式不正确或显示错误
**解决**:
1. 清除浏览器缓存
2. 检查数据处理逻辑
3. 验证API响应格式

### 性能问题
**问题**: 大数据量时页面加载缓慢
**解决**:
1. 启用数据分页
2. 使用数据缓存
3. 优化图表渲染

## 📈 性能优化

### 前端优化
- **数据分页** - 分页加载大量数据
- **虚拟滚动** - 大数据量表格优化
- **懒加载** - 图表和组件按需加载

### 后端优化
- **数据缓存** - Redis缓存热点数据
- **数据库索引** - 优化查询性能
- **API限流** - 防止API滥用

## 🔒 安全考虑

### 数据安全
- **敏感信息脱敏** - 不显示用户敏感信息
- **访问权限控制** - 基于角色的数据访问控制
- **数据加密传输** - HTTPS加密数据传输

### 系统安全
- **XSS防护** - 前端XSS攻击防护
- **CSRF防护** - 跨站请求伪造防护
- **输入验证** - 严格的输入数据验证

## 📚 相关文档

- [主项目README](../README.md)
- [API文档](../DOUYIN_API_GUIDE.md)
- [数据库文档](../DATABASE-README.md)
- [权限控制指南](../PERMISSION-CONTROL-GUIDE.md)

## 📞 技术支持

如有问题，请联系开发团队或提交GitHub Issue。

---

**最后更新**: 2025-09-15
**模块版本**: v1.0.0