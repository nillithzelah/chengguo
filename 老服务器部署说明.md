# è€æœåŠ¡å™¨éƒ¨ç½²è¯´æ˜

## ğŸ“‹ éƒ¨ç½²æ¦‚è¿°

éœ€è¦å°†é”€å”®è§’è‰²åŠŸèƒ½éƒ¨ç½²åˆ°è€æœåŠ¡å™¨ (47.115.94.203)ï¼ŒåŒ…æ‹¬ï¼š
1. æ›´æ–°æ•°æ®åº“è¡¨ç»“æ„ï¼ˆæ·»åŠ signer_nameå­—æ®µï¼‰
2. åˆ›å»ºé”€å”®ç”¨æˆ·ï¼ˆè¢ã€èµµï¼‰
3. ä¸Šä¼ æ›´æ–°åçš„ä»£ç æ–‡ä»¶
4. é‡å¯æœåŠ¡

## ğŸ”§ æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤1: è¿æ¥åˆ°è€æœåŠ¡å™¨
```bash
ssh -i ~/.ssh/id_rsa_douyin root@47.115.94.203
cd /var/www/douyin-admin-master
```

### æ­¥éª¤2: å¤‡ä»½æ•°æ®åº“
```bash
cp database.sqlite database.sqlite.backup.$(date +%Y%m%d_%H%M%S)
```

### æ­¥éª¤3: ä¸Šä¼ æ›´æ–°æ–‡ä»¶
åœ¨æœ¬åœ°æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¸Šä¼ æ–‡ä»¶ï¼š

```bash
# ä¸Šä¼ æ¨¡å‹æ–‡ä»¶
scp -i ~/.ssh/id_rsa_douyin models/*.js root@47.115.94.203:/var/www/douyin-admin-master/models/

# ä¸Šä¼ æœåŠ¡å™¨æ–‡ä»¶
scp -i ~/.ssh/id_rsa_douyin server.js root@47.115.94.203:/var/www/douyin-admin-master/

# ä¸Šä¼ è·¯ç”±é…ç½®
scp -i ~/.ssh/id_rsa_douyin -r src/router/ root@47.115.94.203:/var/www/douyin-admin-master/src/

# ä¸Šä¼ å®¢æˆ·ç®¡ç†é¡µé¢
scp -i ~/.ssh/id_rsa_douyin src/views/user/customer-management/index.vue root@47.115.94.203:/var/www/douyin-admin-master/src/views/user/customer-management/

# ä¸Šä¼ æƒé™ç›¸å…³æ–‡ä»¶
scp -i ~/.ssh/id_rsa_douyin src/hooks/permission.ts root@47.115.94.203:/var/www/douyin-admin-master/src/hooks/

# ä¸Šä¼ é”€å”®ç”¨æˆ·åˆ›å»ºè„šæœ¬
scp -i ~/.ssh/id_rsa_douyin scripts/database/create-sales-users-for-old-server.js root@47.115.94.203:/var/www/douyin-admin-master/scripts/database/
```

### æ­¥éª¤4: åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œéƒ¨ç½²
```bash
cd /var/www/douyin-admin-master

# æ£€æŸ¥æ•°æ®åº“è¡¨ç»“æ„
node scripts/database/check-table-structure.js

# åŒæ­¥æ•°æ®åº“è¡¨ç»“æ„ï¼ˆæ·»åŠ signer_nameå­—æ®µï¼‰
node scripts/database/sync-customers-table.js

# åˆ›å»ºé”€å”®ç”¨æˆ·
node scripts/database/create-sales-users-for-old-server.js

# é‡å¯æœåŠ¡
pm2 restart douyin-admin
```

### æ­¥éª¤5: éªŒè¯éƒ¨ç½²
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 status

# æ£€æŸ¥æ—¥å¿—
pm2 logs douyin-admin --lines 20

# æµ‹è¯•API
curl http://localhost:3000/api/health
```

## ğŸ“‹ é”€å”®ç”¨æˆ·ç™»å½•ä¿¡æ¯

éƒ¨ç½²å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è´¦å·ç™»å½•ï¼š

- **ç”¨æˆ·å**: `è¢`, **å¯†ç **: `yuan123`
- **ç”¨æˆ·å**: `èµµ`, **å¯†ç **: `zhao123`

## ğŸ”— è®¿é—®åœ°å€

- **ç½‘ç«™åœ°å€**: http://47.115.94.203
- **APIåœ°å€**: http://47.115.94.203/api/

## âœ… é”€å”®è§’è‰²æƒé™

é”€å”®ç”¨æˆ·ç™»å½•åå¯ä»¥çœ‹åˆ°ï¼š
- âœ… å¹¿å‘Šæ•°æ®èœå•ï¼ˆçˆ¶èœå•ï¼‰
  - âœ… ç™½æ¸¸ECPMæ•°æ®æŸ¥çœ‹
  - âœ… ç°æ¸¸ECPMæ•°æ®æŸ¥çœ‹
- âœ… ç”¨æˆ·ç®¡ç†èœå•ï¼ˆçˆ¶èœå•ï¼‰
  - âœ… å®¢æˆ·ç®¡ç†ï¼ˆå¯æŸ¥çœ‹ã€åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å®¢æˆ·ï¼‰

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¦‚æœéƒ¨ç½²å¤±è´¥
1. æ£€æŸ¥SSHè¿æ¥ï¼š`ssh -i ~/.ssh/id_rsa_douyin root@47.115.94.203`
2. æ£€æŸ¥æ–‡ä»¶æƒé™ï¼š`ls -la /var/www/douyin-admin-master/`
3. æ£€æŸ¥æ•°æ®åº“ï¼š`node scripts/database/check-table-structure.js`
4. æŸ¥çœ‹PM2æ—¥å¿—ï¼š`pm2 logs douyin-admin`

### å¦‚æœé”€å”®ç”¨æˆ·æ— æ³•ç™»å½•
1. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦åˆ›å»ºæˆåŠŸï¼š`node scripts/database/create-sales-users-for-old-server.js`
2. æ£€æŸ¥ç”¨æˆ·çŠ¶æ€ï¼šæ•°æ®åº“ä¸­is_activeå­—æ®µåº”ä¸ºtrue

---

**éƒ¨ç½²æ—¶é—´**: 2025-12-03
**è´Ÿè´£äºº**: ç³»ç»Ÿç®¡ç†å‘˜