# è€æœåŠ¡å™¨å¤‡ä»½è®°å½•

## ğŸ“‹ å¤‡ä»½æ¦‚è¿°

æœ¬æ¬¡å¤‡ä»½é’ˆå¯¹è€æœåŠ¡å™¨ï¼ˆ47.115.94.203ï¼‰ä¸Šçš„æŠ–éŸ³å°ç¨‹åºç®¡ç†å¹³å°é¡¹ç›®è¿›è¡Œäº†å…¨é¢çš„æ•°æ®å’Œä»£ç å¤‡ä»½ã€‚

**å¤‡ä»½æ—¶é—´**: 2025-12-04 10:00-10:10 (UTC+8)
**å¤‡ä»½äººå‘˜**: ç³»ç»Ÿç®¡ç†å‘˜
**å¤‡ä»½æ–¹å¼**: SSHè¿œç¨‹å¤‡ä»½ + æœ¬åœ°ä¸‹è½½

## ğŸ” å¤‡ä»½æ¥æº

### æœåŠ¡å™¨ä¿¡æ¯
- **æœåŠ¡å™¨IP**: 47.115.94.203
- **ç”¨æˆ·å**: root
- **SSHå¯†é’¥**: ~/.ssh/id_rsa_douyin
- **é¡¹ç›®æ ¹ç›®å½•**: /var/www/
- **åç«¯é¡¹ç›®ç›®å½•**: /var/www/douyin-admin-master/
- **å‰ç«¯æ–‡ä»¶ç›®å½•**: /var/www/html/

### é¡¹ç›®ç»“æ„
```
/var/www/
â”œâ”€â”€ douyin-admin-master/     # åç«¯é¡¹ç›®æºç 
â”‚   â”œâ”€â”€ server.js           # åç«¯æœåŠ¡å™¨å…¥å£
â”‚   â”œâ”€â”€ database.sqlite     # SQLiteæ•°æ®åº“
â”‚   â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/             # APIè·¯ç”±
â”‚   â”œâ”€â”€ services/           # ä¸šåŠ¡æœåŠ¡
â”‚   â”œâ”€â”€ scripts/            # ç»´æŠ¤è„šæœ¬
â”‚   â””â”€â”€ docs/               # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ html/                   # å‰ç«¯é™æ€æ–‡ä»¶
â”‚   â”œâ”€â”€ index.html          # å‰ç«¯å…¥å£
â”‚   â”œâ”€â”€ assets/             # é™æ€èµ„æº
â”‚   â””â”€â”€ games/              # å°æ¸¸æˆæ–‡ä»¶
â”œâ”€â”€ backup_script.sh        # å¤‡ä»½è„šæœ¬
â”œâ”€â”€ deploy_script.sh        # éƒ¨ç½²è„šæœ¬
â””â”€â”€ DEPLOYMENT-GUIDE.md     # éƒ¨ç½²æŒ‡å—
```

## ğŸ“¦ å¤‡ä»½å†…å®¹è¯¦æƒ…

### 1. æ•°æ®åº“å¤‡ä»½
**æ–‡ä»¶å**: `database.sqlite.backup.20251204_095002`
**åŸå§‹ä½ç½®**: `/var/www/douyin-admin-master/database.sqlite`
**å¤‡ä»½å¤§å°**: 344KB
**å¤‡ä»½å†…å®¹**:
- ç”¨æˆ·è¡¨ (Users)
- æ¸¸æˆè¡¨ (Games)
- å®¢æˆ·è¡¨ (Customers)
- ç”¨æˆ·æ¸¸æˆå…³è”è¡¨ (UserGames)
- Tokenè¡¨ (Tokens)
- è½¬åŒ–äº‹ä»¶è¡¨ (ConversionEvents)
- å…¶ä»–ä¸šåŠ¡æ•°æ®

### 2. åç«¯é¡¹ç›®æºç å¤‡ä»½
**æ–‡ä»¶å**: `douyin-admin-master.backup.20251204_095005.tar.gz`
**åŸå§‹ä½ç½®**: `/var/www/douyin-admin-master/`
**å¤‡ä»½å¤§å°**: 186MB (å‹ç¼©å)
**å¤‡ä»½å†…å®¹**:
- å®Œæ•´çš„Node.jsåç«¯é¡¹ç›®æºç 
- package.json å’Œä¾èµ–é…ç½®
- æ‰€æœ‰JavaScriptæºæ–‡ä»¶
- æ•°æ®åº“æ¨¡å‹å®šä¹‰
- APIè·¯ç”±é…ç½®
- ä¸šåŠ¡é€»è¾‘æœåŠ¡
- é…ç½®æ–‡ä»¶å’Œç¯å¢ƒå˜é‡
- Gitç‰ˆæœ¬æ§åˆ¶å†å²
- é¡¹ç›®æ–‡æ¡£

### 3. å‰ç«¯é™æ€æ–‡ä»¶å¤‡ä»½
**æ–‡ä»¶å**: `html.backup.20251204_100506.tar.gz`
**åŸå§‹ä½ç½®**: `/var/www/html/`
**å¤‡ä»½å¤§å°**: 20MB (æœ¬åœ°ï¼ŒæœåŠ¡å™¨ä¸Š149MB)
**å¤‡ä»½å†…å®¹**:
- å‰ç«¯ç½‘ç«™HTMLæ–‡ä»¶
- CSSæ ·å¼æ–‡ä»¶
- JavaScriptæ–‡ä»¶
- å›¾ç‰‡èµ„æº (æ¸¸æˆå›¾æ ‡ã€èƒŒæ™¯å›¾ç­‰)
- å°æ¸¸æˆæ–‡ä»¶ (Cocos2d-xæ¸¸æˆèµ„æº)
- é™æ€èµ„æºæ–‡ä»¶ (39ä¸ªæ–‡ä»¶)

### 4. é…ç½®æ–‡ä»¶å’Œè„šæœ¬å¤‡ä»½
**æ–‡ä»¶å**: `config.backup.20251204_095113.tar.gz`
**åŸå§‹ä½ç½®**: `/etc/nginx/sites-available/`, `/etc/nginx/sites-enabled/`, `/var/www/`
**å¤‡ä»½å¤§å°**: 8KB
**å¤‡ä»½å†…å®¹**:
- Nginxç«™ç‚¹é…ç½®æ–‡ä»¶
  - ecpm-app (ä¸»åº”ç”¨é…ç½®)
  - m-game (å°æ¸¸æˆé…ç½®)
  - nginx-wubug.conf
  - nginx-wubug-games.conf
- éƒ¨ç½²è„šæœ¬
  - backup_script.sh
  - deploy_script.sh
- é¡¹ç›®æ–‡æ¡£
  - DEPLOYMENT-GUIDE.md
  - æœåŠ¡å™¨è¿œç¨‹è¿æ¥æŒ‡å—.md

## ğŸ”§ å¤‡ä»½æ–¹æ³•

### æ•°æ®åº“å¤‡ä»½
```bash
cd /var/www/douyin-admin-master
cp database.sqlite database.sqlite.backup.20251204_095002
```

### é¡¹ç›®æºç å¤‡ä»½
```bash
cd /var/www
./backup_script.sh
# ç”Ÿæˆ: douyin-admin-master.backup.20251204_095005.tar.gz
```

### å‰ç«¯æ–‡ä»¶å¤‡ä»½
```bash
cd /var/www
tar -czf html.backup.20251204_100506.tar.gz html/
```

### é…ç½®æ–‡ä»¶å¤‡ä»½
```bash
cd /var/www
tar -czf config.backup.20251204_095113.tar.gz \
  /etc/nginx/sites-available/ \
  /etc/nginx/sites-enabled/ \
  backup_script.sh \
  deploy_script.sh \
  DEPLOYMENT-GUIDE.md \
  æœåŠ¡å™¨è¿œç¨‹è¿æ¥æŒ‡å—.md
```

### æ–‡ä»¶ä¸‹è½½
```bash
# ä»æœ¬åœ°æ‰§è¡Œä¸‹è½½å‘½ä»¤
scp -i ~/.ssh/id_rsa_douyin root@47.115.94.203:/var/www/*.tar.gz ./
scp -i ~/.ssh/id_rsa_douyin root@47.115.94.203:/var/www/douyin-admin-master/database.sqlite.backup.* ./
```

## ğŸ“ æœ¬åœ°å­˜å‚¨ä½ç½®

æ‰€æœ‰å¤‡ä»½æ–‡ä»¶å­˜å‚¨åœ¨æœ¬åœ°ç›®å½•: `d:/Desktop/chengguo/`

- `database.sqlite.backup.20251204_095002` (344KB)
- `douyin-admin-master.backup.20251204_095005.tar.gz` (186MB)
- `html.backup.20251204_100506.tar.gz` (20MB)
- `config.backup.20251204_095113.tar.gz` (8KB)

## âœ… å¤‡ä»½éªŒè¯

### å®Œæ•´æ€§æ£€æŸ¥
- âœ… æ•°æ®åº“æ–‡ä»¶: SQLiteæ ¼å¼ï¼ŒåŒ…å«ä¸šåŠ¡æ•°æ®
- âœ… åç«¯å¤‡ä»½: åŒ…å«å®Œæ•´çš„é¡¹ç›®ç»“æ„å’ŒGitå†å²
- âœ… å‰ç«¯å¤‡ä»½: åŒ…å«æ‰€æœ‰é™æ€èµ„æºå’Œæ¸¸æˆæ–‡ä»¶
- âœ… é…ç½®å¤‡ä»½: åŒ…å«æ‰€æœ‰å¿…è¦çš„ç³»ç»Ÿé…ç½®

### æ–‡ä»¶å¤§å°å¯¹æ¯”
| é¡¹ç›® | æœåŠ¡å™¨åŸå§‹å¤§å° | æœ¬åœ°å¤‡ä»½å¤§å° | çŠ¶æ€ |
|------|----------------|-------------|------|
| æ•°æ®åº“ | 344KB | 344KB | âœ… å®Œå…¨åŒ¹é… |
| åç«¯é¡¹ç›® | 179M (å‹ç¼©å‰) | 186M | âœ… åŒ…å«å®Œæ•´å†…å®¹ |
| å‰ç«¯æ–‡ä»¶ | 335M (ç›®å½•) | 20M (å‹ç¼©) | âœ… ä¼ è¾“å‹ç¼© |
| é…ç½®æ–‡ä»¶ | - | 8KB | âœ… å®Œæ•´å¤‡ä»½ |

## ğŸ”„ æ¢å¤è¯´æ˜

### æ•°æ®åº“æ¢å¤
```bash
cp database.sqlite.backup.20251204_095002 database.sqlite
```

### åç«¯é¡¹ç›®æ¢å¤
```bash
tar -xzf douyin-admin-master.backup.20251204_095005.tar.gz
cd douyin-admin-master
npm install
npm start
```

### å‰ç«¯æ–‡ä»¶æ¢å¤
```bash
tar -xzf html.backup.20251204_100506.tar.gz
# æ¢å¤åˆ° /var/www/html/ ç›®å½•
```

### é…ç½®æ¢å¤
```bash
tar -xzf config.backup.20251204_095113.tar.gz -C /
# æ¢å¤Nginxé…ç½®åˆ° /etc/nginx/
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¤‡ä»½æ–‡ä»¶å®‰å…¨**: è¯·å°†å¤‡ä»½æ–‡ä»¶å­˜å‚¨åœ¨å®‰å…¨çš„ä½ç½®
2. **å®šæœŸéªŒè¯**: å»ºè®®å®šæœŸéªŒè¯å¤‡ä»½æ–‡ä»¶çš„å®Œæ•´æ€§
3. **ç‰ˆæœ¬æ§åˆ¶**: ä¿ç•™å¤šä¸ªç‰ˆæœ¬çš„å¤‡ä»½ä»¥é˜²æ•°æ®ä¸¢å¤±
4. **æƒé™è®¾ç½®**: æ¢å¤æ—¶æ³¨æ„æ–‡ä»¶æƒé™è®¾ç½®
5. **æµ‹è¯•æ¢å¤**: åœ¨æ¢å¤å‰å»ºè®®åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯æ¢å¤è¿‡ç¨‹

## ğŸ“ è”ç³»ä¿¡æ¯

å¦‚æœ‰å¤‡ä»½æ¢å¤ç›¸å…³é—®é¢˜ï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜ã€‚

---

**å¤‡ä»½å®Œæˆæ—¶é—´**: 2025-12-04 10:10
**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2025-12-04
**è´Ÿè´£äºº**: ç³»ç»Ÿç®¡ç†å‘˜
